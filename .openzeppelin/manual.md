# Коробка с таймером

## Стейт-машина

Есть 2 состояния:

1. Открытая, расслабленная.
   Такой мы видим коробку изначально. Не выставлено никаких настроек. Нет действующего графика, нихуя не зафиксировано, твори, творец. И так можно, пока не внесут депозит. .... пара-пара-пам ... В следующий раз коробка будет такой только тогда, когда все платежи будут произведены. Смарт-контракты, блять! Ни-че-го, не по-ме-ня-ть, по-то-м. Пользуйся моментом, пока контракт расслаблен и бездействует. Не откладывай настройку на завтра, если планируешь вносить депозит сегодня! Деньги, конечно же, вперед, однако, конкретно, в этом случае, как видите, несовоевременным депозитом можно сделать себе охуенно и удивительно. Короче, вы поняли. 
2. Закрытая, напряженная.
    После внесения депозита время начала устанавливается на текущее время блокировки. Т.е., ты понял. Ты кнопка-депозит нажаль, дата сегодня-сейчас хуяк, стала "нулево" (ну, как кнопка "тара" на весах...), и от этой даты начал считаться указанный вами до(! б(мяу)ть), депозита, график платежей.

Временную блокировку мы можем включить только когда сперва установили все-все-все параметры (это специально, чтобы побесить пользователя, да, Как стиралка. Не выбрал режимы и вот эту всё херню на болгарском -- нихрена не включится, а если включится -- то это не наша стиралка. Наша метафорическая стиралка не включится совершенно точно).

Функция initialize имеет следующие параметры:
*адрес токена, адрес получателя, тип продолжительности, кратность продолжительности и периоды*

Последние 3 временных параметра обсуждаются ниже.

После настройки -- всё, можно ебашить депозит. Межете ебашить нужную сумму, а дальше наша детка всё сделает сама.

- Имейте в виду, что это работает только с ERC20.
- Не забудьте указать адрес токена, который упаковываете.
- Одобрение erc для контракта блокировки... Акцепт, алоунс и прочую хуйни выставьте там и жмите "отправить"! Ну, вы видели, как это работает на разных проектах где DeFi штуки получают доступ к балансам всего на ваших кошельках и могут творить чо хотят... вот наша коробка должна иметь разрешение творить хуйни не меньше, чем, какой-нибудь, компаунд или юнисвоп! Потому что коробка не должна чувствовать себя обделенной, ясно, блять?!
- Переменная суммы выражается в базовых (wei) единицах. (дохуя-дохуя нулей. дохуя-дохуя-дохуя! будьте внимательны. если вы обнаружили, что нулей не дохуя, то, вот вариант, котоый, мы, естественно, просто написали и нихера сами не проверяли, но вот как можно посчитать правильное дохуя нулей:

если ваш токен имеет 18 знаков после запятой, для отправки 1 токена необходимо ввести число 1000000000000000000.

"Будьте внимательны и выбирайте то самое, ваше, никому нахуй больше не нужное, потому что нужное он посчитает себе сам, правильное дохуе, идущее от вашего сердца..." // говаривали Мартышка с Удавом в мультике, в которой всё измеряли попугаями, а не Бенедиктами Кембербетчами, как нормальные люди.

## Применение

1. После развертывания контракта Lock график перехода прав не активируется до тех пор, пока вы не вызовете функцию «Депозит», установив время начала на «сейчас».
2. Перед вызовом депозита убедитесь, что на кошельке у тебя есть достаточный баланс, чтоб, прям, блять, не меньше, чем ты указал в сумме депозита, чтоб, блять, без наебалова, ясно?! У нас с этим строго.
3. Для контракта коробки должно быть было получено (предоставлено! предоставьте коробке права! она такой же человек, как и ты, пидор! (нет, не ты, а вот тот, который в наушниках)) одобрение (акцепт/алонс/мультипаспорт/вся хуйня) на этот ваш ныкаемый ERC20.

4. Получатель должен дернуть ручку после нужной даты, ага. Само ничего не прилетает, а если прилетает, то мы знаем, кому говорить спасибо, но, контракт сам нихуя никуда ничего не шлет. так что, приходим, смотрим на календарь, вздыхаем (остался еще день), уебываем до нужной даты, а потом берем и жмем чего нужно, а тем, кто будет жать молодцом -- все правильно прилетит.

Обратитесь в СпортЛото, чтобы потребовать накопленные платежи, если вы не прописаны в получателях. Нихера вы, неблагоенадежные и злонамеренные пидоры, не на одно лицо. Мы знаеим как вас различать. У вас разные туфли! 

### Периоды времени

продолжительность
``
        второй = 0,
        минута = 1,
        час = 2,
        день = 3,
        неделя = 4,
        месяц = 5, //неточно, предполагается 30-дневный месяц, с учетом плюсоминусосдвигов, да и нахуй точно писать, потом, может быть, если будет настроение...
        год = 6,
        квартал = 7, //13 недель
        biannual = 8 //26 недель
``
В дополнение к типу продолжительности вы можете установить кратность продолжительности.
- Например. если продолжительность установлена ​​на 5, а кратность на 3, тогда продолжительность между снятием средств составляет 3 недели.
- Если вы установите длительность на число больше 8, то продолжительность будет соответствовать этому числу в секундах. Например, если я установлю продолжительность на 4000, то каждый период будет длиться 4000 секунд.

Наконец, параметр периодов определяет, на сколько периодов будут разделены платежи. Например
Для длительности = 2, кратной длительности = 1 и периодов = 3 будет три платежа с интервалом в час каждый.

### Депозит при переходе

Если контракт находится в состоянии "закрыто", то вызов функции «Депозит» приведет к перерасчету платежей, чтобы гарантировать, что весь баланс будет выплачен до последнего периода.

Например, предположим, что контракт развернут на 12 ежемесячных выплат токена Dai. Депозит составляет 24000 даи, чтобы каждый месяц выпускалось 2000 даи. После 3-го месяца остается 18000 Даи и 9 периодов. Функция депозита вызывается со значением 9000 даи. Итого теперь 27000 Даи, осталось 9 периодов. Контракт немедленно корректирует ежемесячные платежи, так что баланс достигнет нуля через 9 месяцев. Новый ежемесячный платеж составляет (27000/9 =) 3000 Даи.

## Ограничения

- Контракт не поддерживает ETH!!!!!!!!!!!!!!!!!!!!!
- Кошелек получателя может быть изменен только!!!!!!!!!!!!!!! тогда, когда контракт неактивен!!!!!!!!!!!!!!, чтобы сохранить доверие (Д -- Доверие!) в случае передачи токенов командой. Чтобы, короче, сообществу было прозрачнее, а вам, возможно, иногда, мозгоебнее и неудобнее... А, вот, блять, выделите кошелек отдельный под эту хуйню, ага. Или на мультисиг ебашьте... gnosis мне нравится, например. И там можно контракты цеплять к интерфейсу. Я потом попробую коробку прицепить. Если будет заебись, буду с удовольствием пользоваться, а вы, дорогие незнакомые мне юзеры, ебитесь сами, несмотря на то, что ебаться -- стыдно. Давайте, давайте, ага! А еще у опен зеппелин в облаке есть прикольная штука, которой можно цепляться к контрактам. 

# Планы

- Фабрику хочу
- Гуй охуенный или, не охуенный, но, типа, не выдуманный, хочу. Ну, вернее, заранее выдуманный, но, потом, реализованный... т.е., не вообращаемый. Ага.
- Хочу фабрику для erc
- Хочу не каждый раз всё хуйню деплоить, а либа/версия/версия солидити/оптимизация хуякда/оптимизация хуякнет/сколько раз оптимизация делала хуяк...
- Обновленные часли библиотек цеппелинов хочу собрать, да и заебашить в пулл-реквест им.
- Всё нашу хуйню поделить на подключаемые либы
  - Возможно, нужно сделать так, чтоб эти либы были декораторами поверх дефолтных опензеппелинолвских либ
- Хочу автоматизация для всей процедуры от настройки, до верификации.
- Автоматически, блять!!!!!!!
- Сделай CI!!!!!!
- Сделай CD!!!!!!
- Заебашь между ними слеш!
- Выебывайся, что у тебя всё охуенно деповсится (а это на 1 оправдание больше, чем было до, на тему "почему я не планирую искать себе женщину", а это, уже что-то...
- Напишите мне здесь разных идей, нахуярьте пулл-реквестами их туда в репу куда-нибудь, куда я, в итоге, эту хуйню охуенно аккуратненько разложу (но на локале, вам я буду пушить как и сейчас, ага, нехуй расслабляться)
- Хочу охуеннских брюнеток-близняшек с длинными ногами, технической вышкой и свободным времением и знанием, как до меня доехать прямо сейчас...

Мазел Тов